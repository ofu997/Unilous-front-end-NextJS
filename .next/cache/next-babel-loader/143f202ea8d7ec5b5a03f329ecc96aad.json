{"ast":null,"code":"var __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { useQuery } from '@apollo/react-hooks';\nimport { LIST_OF_NOTIFICATIONS } from '../../../src/schemas/queries';\nimport { setCurrentUserNotifications } from '../../../redux/reducers/currentUser';\nimport Notif from './Notif';\nimport Loading from '../../Loading';\nimport apollo, { apolloClient } from '../../../lib/apollo';\nimport { bindActionCreators } from 'redux';\nimport UR from '../../../styles/user/user.module.css';\nimport UU from '../../../styles/user/userUtilities.module.css';\n\nconst UserNotifList = props => {\n  // const notifsListQuery = useQuery(LIST_OF_NOTIFICATIONS, {\n  //     variables: {notifications: props.currentUser.notifications.map(n => n._id)}\n  // })\n  // console.log(notifsListQuery)\n  // const notifsListQuery = apolloClient.query({\n  //     query: LIST_OF_NOTIFICATIONS,\n  //     variables: {notifications: props.currentUser.notifications.map(n => n._id)}\n  // }).catch(err => console.log(err))\n  const {\n    0: sentFilter,\n    1: setSentFilter\n  } = useState('to you');\n  const {\n    0: showSFDD,\n    1: setShowSFDD\n  } = useState(false);\n  const {\n    0: statusFilter,\n    1: setStatusFilter\n  } = useState('pending');\n  const {\n    0: showStatusDD,\n    1: setShowStatusDD\n  } = useState(false); // const notifsListConditions = (query, reducer) => {\n  //     if (!query) { return null }\n  //     if (reducer.length === 0) { return null }\n  //     if (reducer[0].userTo) {\n  //         if (query._id === reducer[0]._id ) { return null }\n  //     }\n  //     return query\n  // }\n  // const notifsList = notifsListConditions(notifsListQuery.data.listOfNotifications, props.currentUser.notifications)\n  // useEffect(() => {\n  //     if (notifsList) {\n  //         props.setCurrentUserNotifications(notifsList)\n  //     }\n  // }, [notifsList, props, props.setCurrentUserNotifications])\n\n  if (props.currentUser.notifications.length > 0) {\n    if (!props.currentUser.notifications[0].userTo) {\n      return __jsx(\"div\", {\n        style: {\n          gridColumn: '1/3'\n        }\n      }, __jsx(\"div\", {\n        style: {\n          height: '5vh'\n        }\n      }), __jsx(Loading, {\n        color: \"white\"\n      }));\n    }\n  }\n\n  const Filter = () => {\n    const sentOptions = () => {\n      const allOptions = ['from you', 'to you'];\n\n      const onOptionClick = option => {\n        setSentFilter(option);\n        setShowSFDD(!showSFDD);\n      };\n\n      return allOptions.map(o => o !== sentFilter ? __jsx(\"div\", {\n        onClick: () => onOptionClick(o),\n        className: UU.NFDDOption,\n        key: `SFDD${o}`\n      }, o) : null);\n    };\n\n    const sentDD = showSFDD ? __jsx(\"div\", {\n      className: UU.NFropdown\n    }, __jsx(\"div\", {\n      className: UU.NFSplitter\n    }), sentOptions()) : null;\n\n    const statusOptions = () => {\n      const allOptions = ['all', 'accepted', 'declined', 'pending', 'messages'];\n\n      const onOptionClick = option => {\n        setStatusFilter(option);\n        setShowStatusDD(!showStatusDD);\n      };\n\n      return allOptions.map(o => o !== statusFilter ? __jsx(\"div\", {\n        onClick: () => onOptionClick(o),\n        className: `${o}-option ${UU.NFDDOption}`,\n        key: `StatusDD${o}`\n      }, o) : null);\n    };\n\n    const statusDD = showStatusDD ? __jsx(\"div\", {\n      className: UU.NFDropdown\n    }, __jsx(\"div\", {\n      className: UU.NFSplitter\n    }), statusOptions()) : null;\n    return __jsx(\"div\", {\n      className: UU.notifFilterContainer\n    }, __jsx(\"div\", {\n      className: UU.NFCreatorContainer\n    }, __jsx(\"h4\", {\n      className: UU.NFLabel\n    }, \"status\"), __jsx(\"div\", {\n      className: UU.NFOptionContainer\n    }, __jsx(\"div\", {\n      onClick: () => setShowStatusDD(!showStatusDD),\n      className: `${statusFilter}-option ${UU.NFOption}`\n    }, statusFilter), statusDD)), __jsx(\"div\", {\n      className: UU.NFCreatorContainer,\n      style: {\n        marginLeft: '15px'\n      }\n    }, __jsx(\"h4\", {\n      className: UU.NFLabel\n    }, \"sent\"), __jsx(\"div\", {\n      className: UU.NFOptionContainer\n    }, __jsx(\"div\", {\n      onClick: () => setShowSFDD(!showSFDD),\n      className: UU.NFOption\n    }, sentFilter), sentDD)));\n  };\n\n  const statusConditions = notif => {\n    if (statusFilter === 'all') return true;\n    const notifStatus = notif.accepted === null ? 'pending' : notif.accepted ? notif.post ? 'accepted' : 'messages' : 'declined';\n    if (statusFilter === notifStatus) return true;\n    return false;\n  };\n\n  const sentConditions = notif => {\n    if (sentFilter === 'all') return true;\n    const sentStatus = notif.userFrom.username === props.currentUser.username ? 'from you' : 'to you';\n    if (sentFilter === sentStatus) return true;\n    return false;\n  };\n\n  const showNotifications = props.currentUser.notifications.map(n => {\n    if (statusConditions(n) && sentConditions(n)) {\n      return __jsx(Notif, {\n        notif: n,\n        key: `UN${n._id}`\n      });\n    }\n\n    return null;\n  }).reverse();\n  return __jsx(\"div\", {\n    className: \"userUtil-notif\"\n  }, __jsx(Filter, null), __jsx(\"div\", {\n    style: {\n      height: '10px'\n    }\n  }), showNotifications, __jsx(\"div\", {\n    style: {\n      height: '10px'\n    }\n  }));\n};\n\nconst mapStateToProps = state => {\n  return {\n    currentUser: state.currentUser\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setCurrentUserNotifications: bindActionCreators(setCurrentUserNotifications, dispatch)\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(UserNotifList);","map":null,"metadata":{},"sourceType":"module"}